<h1 id="name-lookup">Name lookup</h1>
<!--
Part of the Carbon Language project, under the Apache License v2.0 with LLVM
Exceptions. See /LICENSE for license information.
SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
-->

<!-- toc -->

<h2 id="table-of-contents">Table of contents</h2>
<ul>
<li><a href="#todo">TODO</a></li>
<li><a href="#overview">Overview</a>
<ul>
<li><a href="#unqualified-name-lookup">Unqualified name lookup</a>
<ul>
<li><a href="#alternatives">Alternatives</a></li>
</ul></li>
<li><a href="#name-lookup-for-common-standard-types">Name lookup for common, standard types</a></li>
</ul></li>
<li><a href="#open-questions">Open questions</a>
<ul>
<li><a href="#shadowing">Shadowing</a></li>
</ul></li>
</ul>
<!-- tocstop -->

<h2 id="todo">TODO</h2>
<p>This is a skeletal design, added to support <a href="index.html">the overview</a>. It should not be treated as accepted by the core team; rather, it is a placeholder until we have more time to examine this detail. Please feel welcome to rewrite and update as appropriate.</p>
<h2 id="overview">Overview</h2>
<p>Names are always introduced into some scope which defines where they can be referenced. Many of these scopes are themselves named. Carbon has a special facility for introducing a dedicated named scope just like C++, but we traverse nested names in a uniform way with <code>.</code>-separated names:</p>
<pre><code>namespace Foo {
  namespace Bar {
    alias ??? MyInt = Int;
  }
}

fn F(x: Foo.Bar.MyInt);</code></pre>
<p>Carbon packages are also namespaces so to get to an imported name from the <code>Abseil</code> package you would write <code>Abseil.Foo</code>. The "top-level" file scope is that of the Carbon package containing the file, meaning that there is no "global" scope. Dedicated namespaces can be reopened within a package, but there is no way to reopen a package without being a library and file <em>within</em> that package.</p>
<p>Note that libraries (unlike packages) do <strong>not</strong> introduce a scope, they share the scope of their package. This is based on the observation that in practice, a fairly coarse scoping tends to work best, with some degree of global registry to establish a unique package name.</p>
<h3 id="unqualified-name-lookup">Unqualified name lookup</h3>
<p>Unqualified name lookup in Carbon will always find a file-local result, other than the implicit "prelude" of importing and aliasing the fundamentals of the standard library. There will be an explicit mention of the name in the file that declares the name in the current or enclosing scope, which must also precede the reference.</p>
<h4 id="alternatives">Alternatives</h4>
<p>This implies that other names within your own package but not declared within the file must be found by way of the package name. It isn't clear if this is the desirable end state. We need to consider alternatives where names from the same library or any library in the same package are made immediately visible within the package scope for unqualified name lookup.</p>
<h3 id="name-lookup-for-common-standard-types">Name lookup for common, standard types</h3>
<p>The Carbon standard library is in the <code>Carbon</code> package. A very small subset of this standard library is provided implicitly in every file's scope. This is called the "prelude" package.</p>
<p>Names in the prelude package will be available without scoping names. For example, <code>Bool</code> will be the commonly used name in code, even though the underlying type may be <code>Carbon::Bool</code>. Also, no <code>import</code> will be necessary to use <code>Bool</code>.</p>
<h2 id="open-questions">Open questions</h2>
<h3 id="shadowing">Shadowing</h3>
<p>We can probably disallow the use of shadowed unqualified names, but the actual design for such needs to be thought through.</p>
