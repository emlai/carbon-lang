
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.3.1, mkdocs-material-8.3.9">
    
    
      
        <title>Safety strategy - Carbon Language</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.1d29e8d0.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      
    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#safety-strategy" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Carbon Language" class="md-header__button md-logo" aria-label="Carbon Language" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Carbon Language
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Safety strategy
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Carbon Language" class="md-nav__button md-logo" aria-label="Carbon Language" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Carbon Language
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        Docs
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2">
          Design
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Design" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Design
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/" class="md-nav__link">
        Language design
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/aliases/" class="md-nav__link">
        Aliases
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/blocks_and_statements/" class="md-nav__link">
        Blocks and statements
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/classes/" class="md-nav__link">
        Classes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/functions/" class="md-nav__link">
        Functions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/metaprogramming/" class="md-nav__link">
        Metaprogramming
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/name_lookup/" class="md-nav__link">
        Name lookup
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/naming_conventions/" class="md-nav__link">
        Naming conventions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/pattern_matching/" class="md-nav__link">
        Pattern matching
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/primitive_types/" class="md-nav__link">
        Primitive types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/templates/" class="md-nav__link">
        Templates
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/tuples/" class="md-nav__link">
        Tuples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/type_inference/" class="md-nav__link">
        Type inference
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/variables/" class="md-nav__link">
        Variables
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_15" type="checkbox" id="__nav_2_15" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_15">
          Code and name organization
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Code and name organization" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_15">
          <span class="md-nav__icon md-icon"></span>
          Code and name organization
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/code_and_name_organization/" class="md-nav__link">
        Code and name organization
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/code_and_name_organization/source_files/" class="md-nav__link">
        Source files
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_16" type="checkbox" id="__nav_2_16" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_16">
          Control flow
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Control flow" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_16">
          <span class="md-nav__icon md-icon"></span>
          Control flow
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/control_flow/" class="md-nav__link">
        Control flow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/control_flow/conditionals/" class="md-nav__link">
        Control flow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/control_flow/loops/" class="md-nav__link">
        Loops
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/control_flow/return/" class="md-nav__link">
        `return`
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_17" type="checkbox" id="__nav_2_17" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_17">
          Expressions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Expressions" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_17">
          <span class="md-nav__icon md-icon"></span>
          Expressions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/expressions/" class="md-nav__link">
        Expressions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/expressions/arithmetic/" class="md-nav__link">
        Arithmetic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/expressions/as_expressions/" class="md-nav__link">
        `as` expressions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/expressions/bitwise/" class="md-nav__link">
        Bitwise and shift operators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/expressions/comparison_operators/" class="md-nav__link">
        Comparison operators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/expressions/if/" class="md-nav__link">
        `if` expressions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/expressions/implicit_conversions/" class="md-nav__link">
        Implicit conversions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/expressions/logical_operators/" class="md-nav__link">
        Logical operators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/expressions/member_access/" class="md-nav__link">
        Qualified names and member access
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_18" type="checkbox" id="__nav_2_18" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_18">
          Generics
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Generics" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_18">
          <span class="md-nav__icon md-icon"></span>
          Generics
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/generics/" class="md-nav__link">
        Generics
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/generics/appendix-coherence/" class="md-nav__link">
        Carbon: alternatives to coherence
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/generics/details/" class="md-nav__link">
        Generics: Details
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/generics/goals/" class="md-nav__link">
        Generics: Goals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/generics/overview/" class="md-nav__link">
        Generics: Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/generics/terminology/" class="md-nav__link">
        Generics: Terminology
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_19" type="checkbox" id="__nav_2_19" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_19">
          Interoperability
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Interoperability" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_19">
          <span class="md-nav__icon md-icon"></span>
          Interoperability
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/interoperability/" class="md-nav__link">
        Bidirectional interoperability with C/C++
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/interoperability/philosophy_and_goals/" class="md-nav__link">
        Interoperability philosophy and goals
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2_20" type="checkbox" id="__nav_2_20" >
      
      
      
      
        <label class="md-nav__link" for="__nav_2_20">
          Lexical conventions
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Lexical conventions" data-md-level="2">
        <label class="md-nav__title" for="__nav_2_20">
          <span class="md-nav__icon md-icon"></span>
          Lexical conventions
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/lexical_conventions/" class="md-nav__link">
        Lexical conventions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/lexical_conventions/numeric_literals/" class="md-nav__link">
        Numeric literals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/lexical_conventions/string_literals/" class="md-nav__link">
        String literals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/lexical_conventions/whitespace/" class="md-nav__link">
        Whitespace
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../design/lexical_conventions/words/" class="md-nav__link">
        Words
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Guides
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Guides" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Guides
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/" class="md-nav__link">
        Guides
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../guides/glossary/" class="md-nav__link">
        Glossary
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      
      
      
        <label class="md-nav__link" for="__nav_4">
          Images
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Images" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Images
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../images/snippets/" class="md-nav__link">
        Front page snippets for Carbon
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5">
          Project
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Project" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Project
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        Project
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../code_review/" class="md-nav__link">
        Code review
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../contribution_tools/" class="md-nav__link">
        Contribution tools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../cpp_style_guide/" class="md-nav__link">
        C++ style guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../design_style_guide/" class="md-nav__link">
        Language design style guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../difficulties_improving_cpp/" class="md-nav__link">
        Difficulties improving C++
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../evolution/" class="md-nav__link">
        Evolution and governance
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../faq/" class="md-nav__link">
        Project FAQ
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../goals/" class="md-nav__link">
        Goals
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../groups/" class="md-nav__link">
        Groups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../pull_request_workflow/" class="md-nav__link">
        Trunk-based pull-request GitHub workflow
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roadmap/" class="md-nav__link">
        Roadmap
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../roadmap_process/" class="md-nav__link">
        Roadmap process
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5_14" type="checkbox" id="__nav_5_14" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_5_14">
          Principles
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Principles" data-md-level="2">
        <label class="md-nav__title" for="__nav_5_14">
          <span class="md-nav__icon md-icon"></span>
          Principles
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        Principles
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../error_handling/" class="md-nav__link">
        Principle: Errors are values
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../information_accumulation/" class="md-nav__link">
        Principle: Information accumulation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../library_apis_only/" class="md-nav__link">
        Principle: All APIs are library APIs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../low_context_sensitivity/" class="md-nav__link">
        Principle: Low context-sensitivity
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../one_way/" class="md-nav__link">
        Principle: Prefer providing only one way to do a given thing
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Safety strategy
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Safety strategy
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    Table of contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    Background
  </a>
  
    <nav class="md-nav" aria-label="Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-safety-means-in-carbon" class="md-nav__link">
    What "safety" means in Carbon
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#safety-guarantees-versus-hardening" class="md-nav__link">
    Safety guarantees versus hardening
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#philosophy" class="md-nav__link">
    Philosophy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#principles" class="md-nav__link">
    Principles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#details" class="md-nav__link">
    Details
  </a>
  
    <nav class="md-nav" aria-label="Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#incremental-work-when-safety-requires-work" class="md-nav__link">
    Incremental work when safety requires work
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-build-modes-to-manage-safety-checks" class="md-nav__link">
    Using build modes to manage safety checks
  </a>
  
    <nav class="md-nav" aria-label="Using build modes to manage safety checks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debug" class="md-nav__link">
    Debug
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    Performance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardened" class="md-nav__link">
    Hardened
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#managing-bugs-without-compile-time-safety" class="md-nav__link">
    Managing bugs without compile-time safety
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caveats" class="md-nav__link">
    Caveats
  </a>
  
    <nav class="md-nav" aria-label="Caveats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#probabilistic-techniques-likely-cannot-stop-attacks" class="md-nav__link">
    Probabilistic techniques likely cannot stop attacks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternatives-considered" class="md-nav__link">
    Alternatives considered
  </a>
  
    <nav class="md-nav" aria-label="Alternatives considered">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#guaranteed-memory-safety-programming-models" class="md-nav__link">
    Guaranteed memory safety programming models
  </a>
  
    <nav class="md-nav" aria-label="Guaranteed memory safety programming models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#guaranteed-compile-time-memory-safety-using-borrow-checking" class="md-nav__link">
    Guaranteed compile-time memory safety using borrow checking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guaranteed-run-time-memory-safety-using-reference-counting" class="md-nav__link">
    Guaranteed run-time memory safety using reference counting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guaranteed-run-time-memory-safety-using-garbage-collection" class="md-nav__link">
    Guaranteed run-time memory safety using garbage collection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-mode-names" class="md-nav__link">
    Build mode names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-versus-safety-in-the-hardened-build-mode" class="md-nav__link">
    Performance versus safety in the hardened build mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-more-build-modes" class="md-nav__link">
    Add more build modes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../static_open_extension/" class="md-nav__link">
        Principle: One static open extension mechanism
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../success_criteria/" class="md-nav__link">
        Principle: Success criteria
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6">
          Spec
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Spec" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Spec
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../spec/" class="md-nav__link">
        Spec
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_2" type="checkbox" id="__nav_6_2" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_2">
          Lang
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Lang" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_2">
          <span class="md-nav__icon md-icon"></span>
          Lang
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../spec/lang/" class="md-nav__link">
        Carbon language specification
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../spec/lang/execution/" class="md-nav__link">
        Execution
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../spec/lang/lex/" class="md-nav__link">
        Lexical analysis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../spec/lang/libs/" class="md-nav__link">
        Libraries and packages
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../spec/lang/names/" class="md-nav__link">
        Names
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../spec/lang/parsing/" class="md-nav__link">
        Parsing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../spec/lang/semantics/" class="md-nav__link">
        Semantic analysis
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6_3" type="checkbox" id="__nav_6_3" >
      
      
      
      
        <label class="md-nav__link" for="__nav_6_3">
          Lib
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Lib" data-md-level="2">
        <label class="md-nav__title" for="__nav_6_3">
          <span class="md-nav__icon md-icon"></span>
          Lib
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../../spec/lib/" class="md-nav__link">
        Carbon standard library specification
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    Table of contents
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#background" class="md-nav__link">
    Background
  </a>
  
    <nav class="md-nav" aria-label="Background">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#what-safety-means-in-carbon" class="md-nav__link">
    What "safety" means in Carbon
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#safety-guarantees-versus-hardening" class="md-nav__link">
    Safety guarantees versus hardening
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#philosophy" class="md-nav__link">
    Philosophy
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#principles" class="md-nav__link">
    Principles
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#details" class="md-nav__link">
    Details
  </a>
  
    <nav class="md-nav" aria-label="Details">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#incremental-work-when-safety-requires-work" class="md-nav__link">
    Incremental work when safety requires work
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#using-build-modes-to-manage-safety-checks" class="md-nav__link">
    Using build modes to manage safety checks
  </a>
  
    <nav class="md-nav" aria-label="Using build modes to manage safety checks">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#debug" class="md-nav__link">
    Debug
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance" class="md-nav__link">
    Performance
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#hardened" class="md-nav__link">
    Hardened
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#managing-bugs-without-compile-time-safety" class="md-nav__link">
    Managing bugs without compile-time safety
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caveats" class="md-nav__link">
    Caveats
  </a>
  
    <nav class="md-nav" aria-label="Caveats">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#probabilistic-techniques-likely-cannot-stop-attacks" class="md-nav__link">
    Probabilistic techniques likely cannot stop attacks
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#alternatives-considered" class="md-nav__link">
    Alternatives considered
  </a>
  
    <nav class="md-nav" aria-label="Alternatives considered">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#guaranteed-memory-safety-programming-models" class="md-nav__link">
    Guaranteed memory safety programming models
  </a>
  
    <nav class="md-nav" aria-label="Guaranteed memory safety programming models">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#guaranteed-compile-time-memory-safety-using-borrow-checking" class="md-nav__link">
    Guaranteed compile-time memory safety using borrow checking
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guaranteed-run-time-memory-safety-using-reference-counting" class="md-nav__link">
    Guaranteed run-time memory safety using reference counting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#guaranteed-run-time-memory-safety-using-garbage-collection" class="md-nav__link">
    Guaranteed run-time memory safety using garbage collection
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#build-mode-names" class="md-nav__link">
    Build mode names
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-versus-safety-in-the-hardened-build-mode" class="md-nav__link">
    Performance versus safety in the hardened build mode
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#add-more-build-modes" class="md-nav__link">
    Add more build modes
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                


<h1 id="safety-strategy">Safety strategy</h1>
<!--
Part of the Carbon Language project, under the Apache License v2.0 with LLVM
Exceptions. See /LICENSE for license information.
SPDX-License-Identifier: Apache-2.0 WITH LLVM-exception
-->

<!-- toc -->

<h2 id="table-of-contents">Table of contents</h2>
<ul>
<li><a href="#background">Background</a><ul>
<li><a href="#what-safety-means-in-carbon">What "safety" means in Carbon</a></li>
<li><a href="#safety-guarantees-versus-hardening">Safety guarantees versus hardening</a></li>
</ul>
</li>
<li><a href="#philosophy">Philosophy</a></li>
<li><a href="#principles">Principles</a></li>
<li><a href="#details">Details</a><ul>
<li><a href="#incremental-work-when-safety-requires-work">Incremental work when safety requires work</a></li>
<li><a href="#using-build-modes-to-manage-safety-checks">Using build modes to manage safety checks</a><ul>
<li><a href="#debug">Debug</a></li>
<li><a href="#performance">Performance</a></li>
<li><a href="#hardened">Hardened</a></li>
</ul>
</li>
<li><a href="#managing-bugs-without-compile-time-safety">Managing bugs without compile-time safety</a></li>
</ul>
</li>
<li><a href="#caveats">Caveats</a><ul>
<li><a href="#probabilistic-techniques-likely-cannot-stop-attacks">Probabilistic techniques likely cannot stop attacks</a></li>
</ul>
</li>
<li><a href="#alternatives-considered">Alternatives considered</a><ul>
<li><a href="#guaranteed-memory-safety-programming-models">Guaranteed memory safety programming models</a><ul>
<li><a href="#guaranteed-compile-time-memory-safety-using-borrow-checking">Guaranteed compile-time memory safety using borrow checking</a></li>
<li><a href="#guaranteed-run-time-memory-safety-using-reference-counting">Guaranteed run-time memory safety using reference counting</a></li>
<li><a href="#guaranteed-run-time-memory-safety-using-garbage-collection">Guaranteed run-time memory safety using garbage collection</a></li>
</ul>
</li>
<li><a href="#build-mode-names">Build mode names</a></li>
<li><a href="#performance-versus-safety-in-the-hardened-build-mode">Performance versus safety in the hardened build mode</a></li>
<li><a href="#add-more-build-modes">Add more build modes</a></li>
</ul>
</li>
</ul>
<!-- tocstop -->

<h2 id="background">Background</h2>
<p>Carbon's goal is to provide
<a href="../../goals/#practical-safety-and-testing-mechanisms">practical safety and testing mechanisms</a>.</p>
<h3 id="what-safety-means-in-carbon">What "safety" means in Carbon</h3>
<p>Safety is protection from software bugs, whether the protection is required by
the language or merely an implementation option. Application-specific logic
errors can be prevented by testing, but can lead to security vulnerabilities in
production. Safety categories will be referred to using names based on the type
of
<a href="https://en.wikipedia.org/wiki/Vulnerability_(computing)#Software_vulnerabilities">security vulnerability</a>
they protect against.</p>
<p>A key subset of safety categories Carbon should address are:</p>
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/Memory_safety"><strong>Memory safety</strong></a> protects
    against invalid memory accesses. Carbon uses
    <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/spe.2105">two main subcategories</a>
    for memory safety:</p>
<ul>
<li>
<p><em>Spatial</em> memory safety protects against accessing an address that's out
    of bounds for the source. This includes array boundaries, as well as
    dereferencing invalid pointers such as uninitialized pointers, <code>NULL</code> in
    C++, or manufactured pointer addresses.</p>
</li>
<li>
<p><em>Temporal</em> memory safety protects against accessing an address that has
    been deallocated. This includes use-after-free for heap and
    use-after-return for stack addresses.</p>
</li>
</ul>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Type_safety"><strong>Type safety</strong></a> protects
    against accessing valid memory with an incorrect type, also known as "type
    confusion".</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Race_condition#Data_race"><strong>Data race safety</strong></a>
    protects against racing memory access: when a thread accesses (read or
    write) a memory location concurrently with a different writing thread and
    without synchronizing.</p>
</li>
</ul>
<h3 id="safety-guarantees-versus-hardening">Safety guarantees versus hardening</h3>
<p>In providing safety, the underlying goal is to prevent attacks from turning a
<em>logic error</em> into a <em>security vulnerability</em>. The three ways of doing this can
be thought of in terms of how they prevent attacks:</p>
<ul>
<li>
<p><strong>Safety guarantees</strong> prevent bugs. They offer a strong requirement that a
    particular security vulnerability cannot exist. Compile-time safety checks
    are always a safety guarantee, but safety guarantees may also be done at
    runtime. For example:</p>
<ul>
<li>
<p>At compile-time, range-based for loops offer a spatial safety guarantee
    that out-of-bounds issues cannot exist in the absence of concurrent
    modification of the sequence.</p>
</li>
<li>
<p>At runtime, garbage collected languages offer a temporal safety
    guarantee because objects cannot be freed while they're still
    accessible.</p>
</li>
</ul>
</li>
<li>
<p><strong>Error detection</strong> checks for common logic errors at runtime. For example:</p>
<ul>
<li>
<p>An array lookup function might offer spatial memory error detection by
    verifying that the passed index is in-bounds.</p>
</li>
<li>
<p>A program can implement reference counting to detect a temporal memory
    error by checking whether any references remain when memory is freed.</p>
</li>
</ul>
</li>
<li>
<p><strong>Safety hardening</strong> mitigates bugs, typically by minimizing the feasibility
    of an attack. For example:</p>
<ul>
<li>
<p><a href="https://en.wikipedia.org/wiki/Control-flow_integrity">Control Flow Integrity (CFI)</a>
    monitors for behavior which can subvert the program's control flow. In
    <a href="http://clang.llvm.org/docs/ControlFlowIntegrity.html">Clang</a>, it is
    optimized for use in release builds. Typically CFI analysis will only
    detect a subset of attacks because it can't track each possible code
    path separately. It should still reduce the feasibility of both spatial
    memory, temporal memory, and type attacks.</p>
</li>
<li>
<p><a href="https://llvm.org/devmtg/2018-10/slides/Serebryany-Stepanov-Tsyrklevich-Memory-Tagging-Slides-LLVM-2018.pdf">Memory tagging</a>
    makes each attempt at an invalid read or write operation have a high
    probability of trapping, while still not detecting the underlying bug in
    every case. Realistic attacks require many such operations, so memory
    tagging may stop attacks in some environments. Alternatively, the trap
    might be asynchronous, leaving only a tiny window of time prior to the
    attack being detected and program terminated. These are probabilistic
    hardening and reduces the feasibility of both spatial and temporal
    memory attacks.</p>
</li>
</ul>
</li>
</ul>
<p>Under both error detection and safety hardening, even if a safety is protected,
the underlying bugs will still exist and will need to be fixed. For example,
program termination could be used for a denial-of-service attack.</p>
<h2 id="philosophy">Philosophy</h2>
<p>Carbon's
<a href="../../goals/#practical-safety-and-testing-mechanisms">practical safety and testing mechanisms</a>
will emphasize guaranteed safety where feasible without creating barriers to
Carbon's <a href="../../goals/">other goals</a>, particularly performance and
interoperability. This limits Carbon's options for guaranteed safety, and as a
result there will be more reliance upon error detection and safety hardening.
The language's design should incentivize safe programming, although it will not
be required.</p>
<p>When writing code, Carbon developers should expect to receive safety without
needing to add safety annotations. Carbon will have optional safety annotations
for purposes such as optimizing safety checks or providing information that
improves coverage of safety checks.</p>
<p>Carbon will favor compile-time safety checks because catching issues early will
make applications more reliable. Runtime checks, either error detection or
safety hardening, will be enabled where safety cannot be proven at compile-time.</p>
<p>There will be three high-level use cases or directions that Carbon addresses
through different build modes that prioritize safety checks differently:</p>
<ul>
<li>A <a href="#debug">debug</a> oriented build mode that prioritizes detecting bugs and
    reporting errors helpfully.</li>
<li>A <a href="#performance">performance</a> oriented build mode that skips any dynamic
    safety checks to reduce overhead.</li>
<li>A <a href="#hardened">hardened</a> oriented build mode that prioritizes ensuring
    sufficient safety to prevent security vulnerabilities, although it may not
    allow detecting all of the bugs.</li>
</ul>
<p>These high level build modes may be tuned, either to select specific nuanced
approach for achieving the high level goal, or to configure orthogonal
constraints such as whether to prioritize binary size or execution speed.
However, there is a strong desire to avoid requiring more fundamental build
modes to achieve the necessary coverage of detecting bugs and shipping software.
These build modes are also not expected to be interchangeable or compatible with
each other within a single executable -- they must be a global selection.</p>
<p>Although expensive safety checks could be provided through additional build
modes, Carbon will favor safety checks that can be combined into these three
build modes rather than adding more.</p>
<p>Over time, safety should <a href="../../goals/#software-and-language-evolution">evolve</a>
using a hybrid compile-time and runtime safety approach to eventually provide a
similar level of safety to a language that puts more emphasis on guaranteed
safety, such as
<a href="#guaranteed-compile-time-memory-safety-using-borrow-checking">Rust</a>. However,
while Carbon may <em>encourage</em> developers to modify code in support of more
efficient safety checks, it will remain important to improve the safety of code
for developers who cannot invest into safety-specific code modifications.</p>
<h2 id="principles">Principles</h2>
<ul>
<li>
<p>Safety must be
    <a href="../../goals/#code-that-is-easy-to-read-understand-and-write">easy to ramp-up with</a>,
    even if it means new developers don't receive the full safety that Carbon
    can offer.</p>
<ul>
<li>
<p>Developers should benefit from Carbon's safety without needing to learn
    and apply Carbon-specific design patterns. Some safety should be enabled
    by default, without safety-specific work, although some safety will
    require work to opt in. Developers concerned with performance should
    only need to disable safety in rare edge-cases.</p>
</li>
<li>
<p>Where there is a choice between safety approaches, the safe option
    should be incentivized by making it equally easy or easier to use. If
    there is a default, it should be the safe option. It should be
    identifiable when the unsafe option is used. Incentives will prioritize,
    in order:</p>
<ol>
<li>Guaranteed safety.</li>
<li>Error detection.</li>
<li>Safety hardening.</li>
<li>Unsafe and unmitigated code.</li>
</ol>
</li>
<li>
<p>Language design choices should favor more efficient implementations of
    safety checks. They should also allow favor automation of testing and
    fuzzing.</p>
</li>
</ul>
</li>
<li>
<p>Safety in Carbon must work with
    <a href="../../goals/#interoperability-with-and-migration-from-existing-c-code">interoperable or migrated C++ code</a>,
    so that C++ developers can readily take advantage of Carbon's improvements.</p>
<ul>
<li>
<p>Safety mechanisms will ideally be designed to apply to automatically
    migrated C++ code. Providing immediate safety improvements to Carbon
    adopters will help motivate adoption.</p>
</li>
<li>
<p>In the other direction, safety mechanisms must not force manual
    rewriting of C++ code in order to migrate, either by creating design
    incompatibilities or performance degradations. Automated migration of
    C++ code to Carbon must work for most developers, even if it forces
    Carbon's safety design to take a different approach.</p>
</li>
<li>
<p>Carbon's safety should degrade gracefully when Carbon code calls C++
    code, although this may require use of the Carbon toolchain to compile
    the C++ code. Applications should be expected to use interoperability.
    Although some safety features will be Carbon-specific, safety should not
    stop at the language boundary.</p>
</li>
</ul>
</li>
<li>
<p>The rules for determining whether code will pass compile-time safety
    checking should be articulable, documented, and easy to understand.</p>
<ul>
<li>Compile-time safety checks should not change significantly across
    different build modes. The purpose of the build modes is to determine
    code generation.</li>
</ul>
</li>
<li>
<p>Each build mode will prioritize performance and safety differently:</p>
<ul>
<li>
<p>The <a href="#debug">debug build mode</a> will produce development-focused binaries
    that prioritize fast iteration on code with safety checks that assist in
    identification and debugging of errors.</p>
</li>
<li>
<p>The <a href="#performance">performance build mode</a> will produce release-focused
    binaries that prioritize performance over safety.</p>
</li>
<li>
<p>The <a href="#hardened">hardened build mode</a> will produce release-focused
    binaries that prioritize safety that is resistant to attacks at the cost
    of performance.</p>
</li>
</ul>
</li>
<li>
<p>Safety checks should try to be identical across build modes.</p>
<ul>
<li>There will be differences, typically due to performance overhead and
    detection rate trade-offs of safety check algorithms.</li>
</ul>
</li>
<li>
<p>The number of build modes will be limited, and should be expected to remain
    at the named three.</p>
<ul>
<li>
<p>Most developers will use two build modes in their work: debug for
    development, and either performance or hardened for releases.</p>
</li>
<li>
<p>It's important to focus on checks that are cheap enough to run as part
    of normal development. Users are not expected to want to run additional
    development build modes for additional sanitizers.</p>
</li>
<li>
<p>Limiting the number of build modes simplifies support for both Carbon
    maintainers, who can focus on a more limited set of configurations, and
    Carbon developers, who can easily choose which is better for their
    use-case.</p>
</li>
</ul>
</li>
<li>
<p>Each distinct safety-related build mode (debug, performance, and hardened)
    cannot be combined with others in the same binary.</p>
<ul>
<li>Cross-binary interfaces will exist in Carbon, and will need to be used
    by developers interested in combining libraries built under different
    build modes.</li>
</ul>
</li>
<li>
<p>Although runtime safety checks should prevent logic errors from turning into
    security vulnerabilities, the underlying logic errors will still be bugs.
    For example, some safety checks would result in application termination;
    this prevents execution of unexpected code and still needs to be fixed.</p>
</li>
<li>
<p>Developers need a strong testing methodology to engineer correct software.
    Carbon will encourage testing and then leverage it with the checking build
    modes to find and fix bugs and vulnerabilities.</p>
</li>
</ul>
<h2 id="details">Details</h2>
<h3 id="incremental-work-when-safety-requires-work">Incremental work when safety requires work</h3>
<p>Carbon is prioritizing usability of the language, particularly minimizing
retraining of C++ developers and easing migration of C++ codebases, over the
kind of provable safety that some other languages pursue, particularly Rust.</p>
<p>A key motivation of Carbon is to move C++ developers to a better, safer
language. However, if Carbon requires manually rewriting or redesigning C++ code
in order to maintain performance, it creates additional pressure on C++
developers to learn and spend time on safety. Safety will often not be the top
priority for developers; as a result, Carbon must be thoughtful about how and
when it forces developers to think about safety.</p>
<p>Relying on multiple build modes to provide safety should fit into normal
development workflows. Carbon can also have features to enable additional
safety, so long as developers can start using Carbon in their applications
<em>without</em> learning new paradigms.</p>
<p>Where possible, safety checks shouldn't require work on the part of Carbon
developers. A safety check that requires no code edits or can be handled by
automated migration may be opt-out, as there is negligible cost to developers.
One which requires local code changes should be opt-in because costs will scale
with codebase size. Safety check approaches which would require substantial
redesign by developers will be disfavored based on adoption cost, even if the
alternative is a less-comprehensive approach.</p>
<h3 id="using-build-modes-to-manage-safety-checks">Using build modes to manage safety checks</h3>
<p>Carbon will likely start in a state where most safety checks are done at
runtime. However, runtime detection of safety violations remains expensive. In
order to make as many safety checks as possible available to developers, Carbon
will adopt a strategy based on three build modes that target key use-cases.</p>
<h4 id="debug">Debug</h4>
<p>The debug build mode targets developers who are iterating on code and running
tests. It will emphasize detection and debugability, especially for safety
issues.</p>
<p>It needs to perform well enough to be run frequently by developers, but will
make performance sacrifices to catch more safety issues. This mode should have
runtime checks for the most common safety issues, but it can make trade-offs
that improve performance in exchange for less frequent, but still reliable,
detection. Developers should do most of their testing in this build mode.</p>
<p>The debug build mode will place a premium on the debugability of safety
violations. Where safety checks rely on hardening instead of guaranteed safety,
violations should be detected with a high probability per single occurrence of
the bug. Detected bugs will be accompanied by a detailed diagnostic report to
ease classification and root cause identification.</p>
<h4 id="performance">Performance</h4>
<p>The performance build mode targets the typical application that wants high
performance from Carbon code, where performance considers processing time,
memory, and disk space. Trade-offs will be made that maximize the performance.</p>
<p>Only safety techniques that don't measurably impact application hot path
performance will be enabled by default. This is a very high bar, but is crucial
for meeting Carbon's performance goals, as well as allowing migration of
existing C++ systems which may not have been designed with Carbon's safety
semantics in mind.</p>
<h4 id="hardened">Hardened</h4>
<p>The hardened build mode targets applications where developers want strong safety
against attacks in exchange for worse performance. It will work to prevent
attacks in ways that
<a href="#probabilistic-techniques-likely-cannot-stop-attacks">attackers cannot work around</a>,
even if it means using techniques that create significant performance costs.</p>
<h3 id="managing-bugs-without-compile-time-safety">Managing bugs without compile-time safety</h3>
<p>Carbon's reliance on runtime checks will allow developers to manage their
security risk. Developers will still need to reliably find and fix the
inevitable bugs, including both safety violations and regular business logic
bugs. The cornerstone of managing bugs will be strong testing methodologies,
with built-in support from Carbon.</p>
<p>Strong testing is more than good test coverage. It means a combination of:</p>
<ul>
<li>
<p>Ensuring unsafe or risky operations and interfaces can easily be recognized
    by developers.</p>
</li>
<li>
<p>Using static analysis tools to detect common bugs, and ensuring they're
    integrated into build and code review workflows. These could be viewed as
    static testing of code.</p>
</li>
<li>
<p>Writing good test coverage, including unit, integration, and system tests.</p>
</li>
<li>
<p>Implementing coverage-directed fuzz testing to discover bugs outside of
    manually authored test coverage, especially for interfaces handling
    untrusted data. Fuzz testing is a robust way to catch bugs when APIs may be
    used in ways developers don't consider.</p>
</li>
<li>
<p>Running continuous integration, including automatic and continuous running
    of these tests. The checked development build mode should be validated, as
    well as any additional build modes necessary to cover different forms of
    behavior checking.</p>
</li>
<li>
<p>Easing automated testing and fuzzing through language features. For example,
    if the language encourages value types and pure functions of some sort, they
    can be automatically fuzzed.</p>
</li>
</ul>
<p>These practices are necessary for reliable, large-scale software engineering.
Maintaining correctness of business logic over time requires continuous and
thorough testing. Without it, such software systems cannot be changed and
evolved over time reliably. Carbon will re-use these practices in conjunction
with checking build modes to mitigate the limitations of Carbon's safety
guarantees without imposing overhead on production systems.</p>
<p>When a developer chooses to use Carbon, adhering to this kind of testing
methodology is essential for maintaining safety. As a consequence, Carbon's
ecosystem, including the language, tools, and libraries, will need to directly
work to remove barriers and encourage the development of these methodologies.</p>
<p>The reliance on testing may make Carbon a poor choice in some environments; in
environments where such testing rigor is infeasible, a language with a greater
degree of static checking may be better suited.</p>
<h2 id="caveats">Caveats</h2>
<h3 id="probabilistic-techniques-likely-cannot-stop-attacks">Probabilistic techniques likely cannot stop attacks</h3>
<p>It's expected that probabilistic techniques that can be applied at the language
level are attackable through a variety of techniques:</p>
<ul>
<li>The attacker might be able to attack repeatedly until it gets through.</li>
<li>The attacker may be able to determine when the attack would be detected and
    only run the attack when it would not be.</li>
<li>The attacker might be able control the test condition to make detection much
    less likely or avoid detection completely. For example, if detection is
    based on the last 4 bits of a memory address, an attacker may be able to
    generate memory allocations, viewing the address and only attacking when
    there's a collision.</li>
</ul>
<p>Hardware vulnerabilities may make these attacks easier than they might otherwise
appear. Future hardware vulnerabilities are difficult to predict.</p>
<p>Note this statement focuses on what can be applied to the language level. Using
a secure hash algorithm, such as SHA256, may be used to offer probabilistic
defense in other situations. However, the overhead of a secure hash algorithm's
calculation is significant in the context of most things that Carbon may do at
the language level.</p>
<p>Combining these issues, although it may seem like a probabilistic safety check
could be proven to reliably detect attackers, it's likely infeasible to do so.
For the various build modes, this means:</p>
<ul>
<li>The debug build mode will not typically be accessible to attackers, so where
    a probabilistic technique provides a better developer experience, it will be
    preferred.</li>
<li>The performance build mode will often avoid safety checks in order to reach
    peak performance. As a consequence, even the weak protection of a
    probabilistic safety check may be used in order to provide <em>some</em>
    protection.</li>
<li>The hardened build mode will prefer non-probabilistic techniques that
    <em>cannot</em> be attacked.</li>
</ul>
<h2 id="alternatives-considered">Alternatives considered</h2>
<h3 id="guaranteed-memory-safety-programming-models">Guaranteed memory safety programming models</h3>
<p>Multiple approaches that would offer guaranteed memory safety have been
considered, mainly based on other languages which offer related approaches.
Carbon will likely rely more on error detection and hardening because of what
the models would mean for Carbon's performance and C++ migration language goals.</p>
<h4 id="guaranteed-compile-time-memory-safety-using-borrow-checking">Guaranteed compile-time memory safety using borrow checking</h4>
<p>Rust offers a good example of an approach for compile-time safety based on
borrow checking, which provides guaranteed safety. For code which can't
implement borrow checking, runtime safety using reference counting is available
and provides reliable error detection. This approach still allows for
<a href="https://doc.rust-lang.org/rust-by-example/unsafe.html"><code>unsafe</code> blocks</a>, as
well as types that offer runtime safety while wrapping <code>unsafe</code> interfaces.</p>
<p>Carbon could use a similar approach for guaranteed safety by default.</p>
<p>Advantages:</p>
<ul>
<li>Guaranteed safety, including against data races, is provided for the
    binaries.<ul>
<li>The emphasis on compile-time safety limits the scope of the runtime
    memory safety costs.</li>
<li>With Rust, there is early evidence that there's a significant impact in
    reducing bugs generally.</li>
</ul>
</li>
<li>Imitating Rust's techniques would allow building on the huge work of the
    Rust community, reducing the risks of implementing similar in Carbon.</li>
<li>Careful use of narrow <code>unsafe</code> escape hatches can be effectively
    encapsulated behind otherwise safe APIs.</li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>Rust's approach to compile-time safety requires use of
    <a href="https://github.com/rust-unofficial/patterns">design patterns and idioms</a>
    that are substantially different from C++.<ul>
<li>Conversion of C++ code to Rust results in either rewrites of code, or
    use of runtime safety checks that impair performance.</li>
<li>Requires fully modeling lifetime and exclusivity in the type system.</li>
<li>Data structures must be redesigned to avoid sharing mutable state.</li>
<li>Increases complexity of node and pointer based data structures, such as
    linked lists.</li>
</ul>
</li>
<li>Imitating Rust's techniques may prove insufficient for achieving Carbon's
    <a href="../../goals/#fast-and-scalable-development">compiler performance goals</a>.
    Rust compilation performance suggests its borrow checking performance is
    slow, although it's difficult to determine how significant this is or
    whether it could be improved.<ul>
<li>The Rust compiler
    <a href="https://pingcap.com/blog/rust-compilation-model-calamity">is slow</a>,
    although
    <a href="https://blog.mozilla.org/nnethercote/2020/09/08/how-to-speed-up-the-rust-compiler-one-last-time/">much has been done to improve it</a>.</li>
<li>Details of type checking, particularly requiring parsing of function
    bodies to type check signatures, as well as wide use of
    <a href="https://doc.rust-lang.org/book/ch10-01-syntax.html">monomorphization</a>
    are likely significant contributors to Rust compilation performance.</li>
<li>LLVM codegen is also a significant cost for Rust compilation
    performance.</li>
<li>With
    <a href="https://fuchsia.dev/fuchsia-src/development/languages/rust">Fuchsia</a> as
    an example, in December 2020, borrow checking and type checking combined
    account for around 10% of Rust compile CPU time, or 25% of end-to-end
    compile time. The current cost of borrow checking is obscured both
    because of the combination with type checking, and because Fuchsia
    disables some compiler parallelization due to build system
    incompatibility.</li>
</ul>
</li>
<li>The complexity of using Rust's compile-time safety may incentivize
    unnecessary runtime checking of safety properties. For example, using
    <a href="https://doc.rust-lang.org/std/cell/struct.RefCell.html"><code>RefCell</code></a> or
    <a href="https://doc.rust-lang.org/std/rc/struct.Rc.html"><code>Rc</code></a> to avoid changing
    designs to fit compile-time safety models.</li>
<li>Some of the most essential safety tools that ease the ergonomic burden of
    the Rust-style lifetime model (<code>Rc</code>) introduce <em>semantic</em> differences that
    cannot then be eliminated in a context where performance is the dominant
    priority.</li>
</ul>
<p>It's possible to modify the Rust model several ways in order to reduce the
burden on C++ developers:</p>
<ul>
<li>Don't offer safety guarantees for data races, eliminating <code>RefCell</code>.<ul>
<li>This would likely not avoid the need for <code>Rc</code> or <code>Arc</code>, and wouldn't
    substantially reduce the complexity.</li>
</ul>
</li>
<li>Require manual destruction of <code>Rc</code>, allowing safety checks to be disabled in
    the performance build mode to eliminate overhead.<ul>
<li>This still requires redesigning C++ code to take advantage of <code>Rc</code>.</li>
<li>The possibility of incorrect manual destruction means that the safety
    issue is being turned into a bug, which means it is hardening and no
    longer a safety guarantee.</li>
<li>Carbon can provide equivalent hardening through techniques such as
    <a href="https://www.cl.cam.ac.uk/~tmj32/papers/docs/ainsworth20-sp.pdf">MarkUs</a>,
    which does not require redesigning C++ code.</li>
</ul>
</li>
</ul>
<p>Overall, Carbon is making a compromise around safety in order to give a path for
C++ to evolve. C++ developers must be comfortable migrating their codebases, and
able to do so in a largely automated manner. In order to achieve automated
migration, Carbon cannot require fundamental redesigns of migrated C++ code.
While a migration tool could in theory mark all migrated code as <code>unsafe</code>,
Carbon should use a safety strategy that degrades gracefully and offers
improvements for C++ code, whether migrated or not.</p>
<p>That does not mean Carbon will never adopt guaranteed safety by default, only
that performance and migration of C++ code takes priority, and any design will
need to be considered in the context of other goals. It should still be possible
to adopt guaranteed safety later, although it will require identifying a
migration path.</p>
<h4 id="guaranteed-run-time-memory-safety-using-reference-counting">Guaranteed run-time memory safety using reference counting</h4>
<p><a href="https://en.wikipedia.org/wiki/Reference_counting">Reference counting</a> is a
common memory safety model, with Swift as a popular example.</p>
<p>Advantages:</p>
<ul>
<li>Simple model for safety, particularly as compared with Rust.</li>
<li>Safe for all of the most common and important classes of memory safety bugs.</li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>Safety based on reference counting introduces significant performance costs,
    and tools for controlling these costs are difficult.<ul>
<li>Safety based on garbage collection has less direct performance overhead,
    but has a greater unpredictability of performance.</li>
</ul>
</li>
<li>Significant design differences versus C++ still result, as the distinction
    between value types and "class types" becomes extremely important.<ul>
<li>Class types are held by a reference counted pointer and are thus
    lifetime safe.</li>
</ul>
</li>
</ul>
<p>In order to mitigate the performance overhead, Swift does have a proposal to add
an option for unique ownership, although the specifics are not designed yet. The
unique ownership approach is expected to require unowned and unsafe access, so
it would not considered to improve the safety trade-offs.</p>
<p>Swift was designated by Apple as the replacement for Objective-C. The safety
versus performance trade-offs that it makes fit Apple's priorities. Carbon's
performance goals should lead to different trade-off decisions with a higher
priority on peak performance, which effectively rules out broad use of reference
counting.</p>
<h4 id="guaranteed-run-time-memory-safety-using-garbage-collection">Guaranteed run-time memory safety using garbage collection</h4>
<p><a href="https://en.wikipedia.org/wiki/Garbage_collection_(computer_science)">Garbage collection</a>
is a common memory safety model, with Java as a popular example.</p>
<p>Advantages:</p>
<ul>
<li>This approach is among the most robust and well studied models, with decades
    of practical usage and analysis for security properties.</li>
<li>Extremely suitable for efficient implementation on top of a virtual machine,
    such as the JVM.</li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>Extremely high complexity to fully understand the implications of complex
    cases like data races.</li>
<li>Performance overhead is significant in terms of what Carbon would like to
    consider.<ul>
<li>Garbage collection remains a difficult performance problem, even for the
    JVM and its extensive optimizations.</li>
<li>The complexity of the implementation makes it difficult to <em>predict</em>
    performance; for example, Java applications experience latency spikes
    when garbage collection runs.</li>
</ul>
</li>
</ul>
<p>Java is a good choice for many applications, but Carbon is working to focus on a
set of performance priorities that would be difficult to achieve with a garbage
collector.</p>
<h3 id="build-mode-names">Build mode names</h3>
<p>The build mode concepts are difficult to name. Other names that were evaluated,
and are ultimately similar, are:</p>
<ul>
<li>
<p>"Debug" is a common term for the intended use of this build mode. Also,
    tooling including Visual Studio frequently uses the debug term for
    describing similar.</p>
<ul>
<li>"Development" was also considered, but this term is less specific and
    would be better for describing all non-release builds together. For
    example, a "fast build" mode might be added that disables safety checks
    to improve iteration time, like might be controlled by way of C++'s
    <code>NDEBUG</code> option.</li>
</ul>
</li>
<li>
<p>"Performance" aligns with the phrasing of the language performance goal.</p>
<ul>
<li>
<p>"Optimized" implies that other modes would not be fully optimized, but
    hardened should be optimized.</p>
</li>
<li>
<p>"Fast" would suggest that speed is the only aspect of performance being
    optimizing for, but "performance" also optimizes for memory usage and
    binary size.</p>
</li>
</ul>
</li>
<li>
<p>"Hardened" is the choice for succinctly describing the additional safety
    measures that will be taken, and is a well-known term in the safety space.
    It could be incorrectly inferred that "performance" has no hardening, but
    the preference is to clearly indicate the priority of the "hardened" build
    mode.</p>
<ul>
<li>
<p>"Safe" implies something closer to guaranteed safety. However, safety
    bugs should be expected to result in program termination, which can
    still be used in other attacks, such as Denial-of-Service.</p>
</li>
<li>
<p>"Mitigated" is an overloaded term, and it may not be succinctly clear
    that it's about security mitigations.</p>
</li>
</ul>
</li>
<li>
<p>Some terms which were considered and don't fit well into the above groups
    are:</p>
<ul>
<li>"Release" is avoided because both "performance" and "hardened" could be
    considered to be "release" build modes.</li>
</ul>
</li>
</ul>
<p>The names "performance" and "hardened" may lead to misinterpretations, with some
developers who should use "hardened" using "performance" because they are
worried about giving up too much performance, and the other way around. The
terms try to balance the utility of well-known terminology with the succinctness
of a short phrase for build modes, and that limits the expressivity. Some
confusion is expected, and documentation as well as real-world experience (for
example, a developer who cares about latency benchmarking both builds) should be
expected to help mitigate mix-ups.</p>
<h3 id="performance-versus-safety-in-the-hardened-build-mode">Performance versus safety in the hardened build mode</h3>
<p>The performance cost of safety techniques are expected to be non-linear with
respect to detection rates. For example, a particular vulnerability such as heap
use-after-free may be detectable with 99% accuracy at 20% performance cost, but
100% accuracy at 50% performance cost. At present, build modes should be
expected to evaluate such a scenario as:</p>
<ul>
<li>The debug build mode would choose the 99% accurate approach.<ul>
<li>Detecting safety issues is valuable for debugging.</li>
<li>The probabilistic detection rate won't meaningfully affect accuracy of
    tests.</li>
<li>The lower performance cost improves developer velocity.</li>
</ul>
</li>
<li>The performance build mode would decline detection.<ul>
<li>Safety checks with a measurable performance cost should be declined.</li>
</ul>
</li>
<li>The hardened build mode would choose the 100% accurate approach.<ul>
<li>Safety must be non-probabilistic in order to reliably prevent attacks.</li>
<li>Significant performance hits are acceptable.</li>
<li>This means the hardened build mode may be slower than the debug build
    mode.</li>
</ul>
</li>
</ul>
<p>In order to achieve better performance, the hardened build mode could make
trade-offs closer to the debug build mode. Rather than relying on
non-probabilistic techniques, it could instead offer a probability-based chance
of detecting a given attack.</p>
<p>Advantages:</p>
<ul>
<li>Probabilistic safety should come at lower performance cost (including CPU,
    memory, and disk space).<ul>
<li>This will sometimes be significant, and as a result of multiple checks,
    could be the difference between the hardened build mode being 50% slower
    than the performance build mode and being 200% slower.</li>
</ul>
</li>
</ul>
<p>Disadvantages:</p>
<ul>
<li><a href="#probabilistic-techniques-likely-cannot-stop-attacks">Probabilistic techniques likely cannot stop attacks</a>.<ul>
<li>Attackers may be able to repeat attacks until they succeed.</li>
<li>The variables upon which the probability is based, such as memory
    addresses, may be manipulable by the attacker. As a consequence, a
    determined attacker may be able to manipulate probabilities and not even
    be detected.</li>
</ul>
</li>
</ul>
<p>Although performance is
<a href="../../goals/#language-goals-and-priorities">Carbon's top goal</a>, the hardened
build mode exists to satisfy developers and environments that value safety more
than performance. The hardened build mode will rely on non-probabilistic safety
at significant performance cost because other approaches will be insufficient to
guard against determined attackers.</p>
<h3 id="add-more-build-modes">Add more build modes</h3>
<p>More build modes could be added to this principle, or the principle could
encourage the idea that specific designs may add more.</p>
<p>To explain why three build modes:</p>
<ul>
<li>
<p>The concept of debug and release (sometimes called opt) are common. For
    example, in
    <a href="https://docs.microsoft.com/en-us/visualstudio/debugger/how-to-set-debug-and-release-configurations?view=vs-2019">Visual Studio</a>.
    In Carbon, this could be considered to translate to the "debug" and
    "performance" build modes by default.</p>
</li>
<li>
<p>The hardened build mode is added in order to emphasize security. Although
    hardened could be implemented as a set of options passed to the standard
    release build mode, the preference is to focus on it as an important
    feature.</p>
</li>
</ul>
<p>An example of why another build mode may be needed is
<a href="https://clang.llvm.org/docs/ThreadSanitizer.html">ThreadSanitizer</a>, which is
noted as having 5-15x slowdown and 5-10x memory overhead. This is infeasible for
normal use, but could be useful for some users in a separate build mode. A
trade-off that's possible for Carbon is instead using an approach similar to
<a href="https://github.com/google/ktsan/wiki/KCSAN">KCSAN</a> which offers relatively
inexpensive but lower-probability race detection.</p>
<p>Although options to these build modes may be supported to customize deployments,
the preference is to focus on a small set and make them behave well. For
example, if a separate build mode is added for ThreadSanitizer, it should be
considered a temporary solution until it can be merged into the debug build
mode.</p>
<p>Advantages:</p>
<ul>
<li>Grants more flexibility for using build modes as a solution to problems.<ul>
<li>With safety checks, this would allow providing safety checks that are
    high overhead but also high detection rate as separate build modes.</li>
<li>With other systems, there could be non-safety performance versus
    behavior trade-offs.</li>
</ul>
</li>
</ul>
<p>Disadvantages:</p>
<ul>
<li>Having standard modes simplifies validation of interactions between various
    safety checks.<ul>
<li>Safety is the only reason that's been considered for adding build modes.</li>
</ul>
</li>
<li>As more build modes are added, the chance of developers being confused and
    choosing the wrong build mode for their application increases.</li>
</ul>
<p>Any long-term additions to the set of build modes will need to update this
principle, raising the visibility and requiring more consideration of such an
addition. If build modes are added for non-safety-related reasons, this may lead
to moving build modes out of the safety strategy.</p>
<p><strong>Experiment</strong>: This can be considered an experiment. Carbon may eventually add
more than the initial three build modes, although the reticence to add more is
likely to remain.</p>

              
            </article>
            
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../one_way/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Principle: Prefer providing only one way to do a given thing" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Principle: Prefer providing only one way to do a given thing
            </div>
          </div>
        </a>
      
      
        
        <a href="../static_open_extension/" class="md-footer__link md-footer__link--next" aria-label="Next: Principle: One static open extension mechanism" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Principle: One static open extension mechanism
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../../..", "features": [], "search": "../../../assets/javascripts/workers/search.b97dbffb.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.6c7ad80a.min.js"></script>
      
    
  </body>
</html>